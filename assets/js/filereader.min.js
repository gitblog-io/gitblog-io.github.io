!function(window,document){function makeWorker(script){var URL=window.URL||window.webkitURL,Blob=window.Blob,Worker=window.Worker;if(!(URL&&Blob&&Worker&&script))return null;var blob=new Blob([script]),worker=new Worker(URL.createObjectURL(blob));return worker}function setupClipboard(element,opts){function onpaste(e){for(var files=[],clipboardData=e.clipboardData||{},items=clipboardData.items||[],i=0;i<items.length;i++){var file=items[i].getAsFile();if(file){var matches=new RegExp("/(.*)").exec(file.type);if(!file.name&&matches){var extension=matches[1];file.name="clipboard"+i+"."+extension}files.push(file)}}files.length&&(processFileList(e,files,instanceOptions),e.preventDefault(),e.stopPropagation())}if(FileReaderJS.enabled){var instanceOptions=extend(extend({},FileReaderJS.opts),opts);element.addEventListener("paste",onpaste,!1)}}function setupInput(input,opts){function inputChange(e){processFileList(e,input.files,instanceOptions)}function inputDrop(e){e.stopPropagation(),e.preventDefault(),processFileList(e,e.dataTransfer.files,instanceOptions)}if(FileReaderJS.enabled){var instanceOptions=extend(extend({},FileReaderJS.opts),opts);input.addEventListener("change",inputChange,!1),input.addEventListener("drop",inputDrop,!1)}}function setupDrop(dropbox,opts){function bodydragend(e){initializedOnBody=!1}function bodydragstart(e){initializedOnBody=!0}function bodydrop(e){e.dataTransfer.files&&e.dataTransfer.files.length&&(e.stopPropagation(),e.preventDefault())}function onlyWithFiles(fn){return function(){initializedOnBody||fn.apply(this,arguments)}}function drop(e){e.stopPropagation(),e.preventDefault(),dragClass&&removeClass(dropbox,dragClass),processFileList(e,e.dataTransfer.files,instanceOptions)}function dragenter(e){e.stopPropagation(),e.preventDefault(),dragClass&&addClass(dropbox,dragClass)}function dragleave(e){dragClass&&removeClass(dropbox,dragClass)}function dragover(e){e.stopPropagation(),e.preventDefault(),dragClass&&addClass(dropbox,dragClass)}if(FileReaderJS.enabled){var instanceOptions=extend(extend({},FileReaderJS.opts),opts),dragClass=instanceOptions.dragClass,initializedOnBody=!1;dropbox.addEventListener("dragenter",onlyWithFiles(dragenter),!1),dropbox.addEventListener("dragleave",onlyWithFiles(dragleave),!1),dropbox.addEventListener("dragover",onlyWithFiles(dragover),!1),dropbox.addEventListener("drop",onlyWithFiles(drop),!1),document.body.addEventListener("dragstart",bodydragstart,!0),document.body.addEventListener("dragend",bodydragend,!0),document.body.addEventListener("drop",bodydrop,!1)}}function setupCustomFileProperties(files,groupID){for(var i=0;i<files.length;i++){var file=files[i];file.extra={nameNoExtension:file.name.substring(0,file.name.lastIndexOf(".")),extension:file.name.substring(file.name.lastIndexOf(".")+1),fileID:i,uniqueID:getUniqueID(),groupID:groupID,prettySize:prettySize(file.size)}}}function getReadAsMethod(type,readAsMap,readAsDefault){for(var r in readAsMap)if(type.match(new RegExp(r)))return"readAs"+readAsMap[r];return"readAs"+readAsDefault}function processFileList(e,files,opts){function groupEnd(){group.ended=new Date,opts.on.groupend(group)}function groupFileDone(){0===--filesLeft&&groupEnd()}var filesLeft=files.length,group={groupID:getGroupID(),files:files,started:new Date};if(FileReaderJS.output.push(group),setupCustomFileProperties(files,group.groupID),opts.on.groupstart(group),!files.length)return void groupEnd();var syncWorker,supportsSync=sync&&FileReaderSyncSupport;supportsSync&&(syncWorker=makeWorker(workerScript),syncWorker.onmessage=function(e){var file=e.data.file,result=e.data.result;file.extra||(file.extra=e.data.extra),file.extra.ended=new Date,opts.on["error"===result?"error":"load"]({target:{result:result}},file),groupFileDone()}),Array.prototype.forEach.call(files,function(file){if(file.extra.started=new Date,opts.accept&&!file.type.match(new RegExp(opts.accept)))return opts.on.skip(file),void groupFileDone();if(opts.on.beforestart(file)===!1)return opts.on.skip(file),void groupFileDone();var readAs=getReadAsMethod(file.type,opts.readAsMap,opts.readAsDefault);if(syncWorker)syncWorker.postMessage({file:file,extra:file.extra,readAs:readAs});else{var reader=new FileReader;reader.originalEvent=e,fileReaderEvents.forEach(function(eventName){reader["on"+eventName]=function(e){("load"==eventName||"error"==eventName)&&(file.extra.ended=new Date),opts.on[eventName](e,file),"loadend"==eventName&&groupFileDone()}}),reader[readAs](file)}})}function checkFileReaderSyncSupport(){var worker=makeWorker(syncDetectionScript);worker&&(worker.onmessage=function(e){FileReaderSyncSupport=e.data},worker.postMessage({}))}function noop(){}function extend(destination,source){for(var property in source)source[property]&&source[property].constructor&&source[property].constructor===Object?(destination[property]=destination[property]||{},arguments.callee(destination[property],source[property])):destination[property]=source[property];return destination}function hasClass(el,name){return new RegExp("(?:^|\\s+)"+name+"(?:\\s+|$)").test(el.className)}function addClass(el,name){hasClass(el,name)||(el.className=el.className?[el.className,name].join(" "):name)}function removeClass(el,name){if(hasClass(el,name)){var c=el.className;el.className=c.replace(new RegExp("(?:^|\\s+)"+name+"(?:\\s+|$)","g")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}function prettySize(bytes){var s=["bytes","kb","MB","GB","TB","PB"],e=Math.floor(Math.log(bytes)/Math.log(1024));return(bytes/Math.pow(1024,Math.floor(e))).toFixed(2)+" "+s[e]}var FileReader=window.FileReader,FileReaderSyncSupport=!1,workerScript="self.addEventListener('message', function(e) { var data=e.data; try { var reader = new FileReaderSync; postMessage({ result: reader[data.readAs](data.file), extra: data.extra, file: data.file})} catch(e){ postMessage({ result:'error', extra:data.extra, file:data.file}); } }, false);",syncDetectionScript="onmessage = function(e) { postMessage(!!FileReaderSync); };",fileReaderEvents=["loadstart","progress","load","abort","error","loadend"],sync=!1,FileReaderJS=window.FileReaderJS={enabled:!1,setupInput:setupInput,setupDrop:setupDrop,setupClipboard:setupClipboard,setSync:function(value){sync=value,sync&&!FileReaderSyncSupport&&checkFileReaderSyncSupport()},getSync:function(){return sync&&FileReaderSyncSupport},output:[],opts:{dragClass:"drag",accept:!1,readAsDefault:"BinaryString",readAsMap:{},on:{loadstart:noop,progress:noop,load:noop,abort:noop,error:noop,loadend:noop,skip:noop,groupstart:noop,groupend:noop,beforestart:noop}}};if("undefined"!=typeof jQuery&&(jQuery.fn.fileReaderJS=function(opts){return this.each(function(){jQuery(this).is("input")?setupInput(this,opts):setupDrop(this,opts)})},jQuery.fn.fileClipboard=function(opts){return this.each(function(){setupClipboard(this,opts)})}),FileReader){var getGroupID=function(id){return function(){return id++}}(0),getUniqueID=function(id){return function(){return id++}}(0);FileReaderJS.enabled=!0}}(this,document);